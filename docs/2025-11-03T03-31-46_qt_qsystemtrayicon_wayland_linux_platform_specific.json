{
  "answer": "**QSystemTrayIcon** exhibits significant platform-specific behavior differences on Linux, especially when comparing traditional X11 environments to modern Wayland-based desktops. The following details the key differences and challenges:\n\n---\n\n### **1. X11 vs. Wayland: System Tray Support**\n\n- **X11:**  \n  On X11, QSystemTrayIcon relies on the [freedesktop.org XEmbed system tray specification](https://standards.freedesktop.org/systemtray-spec/systemtray-spec-0.2.html), which is widely supported by traditional Linux desktop environments (KDE, older GNOME, Xfce, LXQt, etc.)[4][5].  \n  - The tray icon is managed by the window manager or a dedicated system tray applet.\n  - Features like context menus, tooltips, and activation signals are generally supported as expected[5].\n\n- **Wayland:**  \n  Wayland does **not** natively support the legacy XEmbed system tray protocol. Instead, it encourages the use of the [StatusNotifierItem (SNI) specification](https://www.freedesktop.org/wiki/Specifications/StatusNotifierItem/), which is a D-Bus-based protocol[2].  \n  - **KDE Plasma (Wayland):** KDE has implemented a compatibility layer that maps QSystemTrayIcon to SNI, allowing tray icons to work in Plasma Wayland sessions, but this required changes in both Qt and KDE Frameworks and only became robust in Qt 5.4 and later[2].\n  - **GNOME (Wayland):** GNOME Shell removed legacy tray support in version 3.26. Tray icons from QSystemTrayIcon will not appear unless the user installs third-party extensions (e.g., \"AppIndicator\" or \"KStatusNotifierItem\" extensions)[5][4].\n  - **Other Environments:** Support is inconsistent; some environments may not display tray icons at all, or may display them incorrectly (e.g., as blank icons or in unexpected locations)[4].\n\n---\n\n### **2. Application Behavior and Limitations**\n\n- **Detection:**  \n  `QSystemTrayIcon::isSystemTrayAvailable()` may return `false` on Wayland or in environments without a compatible tray implementation, preventing the icon from being shown[1][5].\n\n- **Feature Gaps:**  \n  - **Tooltips and Wheel Events:** Only supported on X11. On Wayland, these events are not delivered to QSystemTrayIcon[5].\n  - **Activation Reasons:** Not all activation reasons (e.g., middle-click, double-click) are supported on GNOME Shell without extensions[5].\n  - **Notifications:** Balloon messages (`showMessage()`) may not appear or may behave differently depending on the environment and user configuration.\n\n- **Implementation Details:**  \n  - On KDE Plasma/Wayland, QSystemTrayIcon is forced to use the SNI API via the platform theme, but this only works if the Qt build and the desktop environment both support it[2].\n  - On GNOME/Wayland, unless an extension is installed, tray icons will not be visible, and there is no fallback[4][8].\n\n---\n\n### **3. Workarounds and Compatibility Layers**\n\n- **XWayland:**  \n  Many Qt applications on Wayland still run under XWayland (an X11 compatibility layer), which allows QSystemTrayIcon to function as it does on X11, but this is not a long-term solution as distributions move toward pure Wayland sessions[3][5].\n\n- **AppIndicator/SNI-Qt:**  \n  Some distributions (notably Ubuntu) use `sni-qt` or similar shims to translate legacy tray icon calls to the SNI protocol, but this is not universal and may not be available or maintained in all environments[2][8].\n\n- **Extensions:**  \n  Users on GNOME/Wayland must install extensions to restore tray icon functionality for legacy applications[8].\n\n---\n\n### **4. Summary Table: QSystemTrayIcon Behavior**\n\n| Environment                | QSystemTrayIcon Support | Notes                                                                                  |\n|----------------------------|------------------------|----------------------------------------------------------------------------------------|\n| KDE Plasma (X11)           | Full                   | Uses XEmbed; all features supported                                                    |\n| KDE Plasma (Wayland)       | Partial/Full           | Uses SNI via platform theme; requires Qt â‰¥ 5.4 and KDE Frameworks integration[2]       |\n| GNOME (X11)                | Partial                | Tray icons may appear, but support is incomplete or buggy in newer GNOME versions[4]   |\n| GNOME (Wayland)            | None/Extension-based   | No native support; requires user-installed extensions for tray icons to appear[4][8]   |\n| Xfce, LXQt, MATE (X11)     | Full                   | Uses XEmbed; tray icons work as expected                                               |\n| Xfce, LXQt, MATE (Wayland) | Varies                 | Depends on compositor and SNI support; often unsupported or buggy                      |\n\n---\n\n### **5. Developer Recommendations**\n\n- **Check for Tray Availability:** Always use `QSystemTrayIcon::isSystemTrayAvailable()` before creating the icon[1].\n- **Target SNI:** For modern Linux desktops, prefer the StatusNotifierItem protocol (directly or via libraries like libappindicator) for maximum compatibility.\n- **Inform Users:** Document any requirements for extensions or compatibility layers on Wayland-based desktops.\n- **Test Across Environments:** Behavior can vary widely; test on both X11 and Wayland, and across major desktop environments.\n\n---\n\n**In summary:**  \n**QSystemTrayIcon** works reliably on X11-based Linux desktops but faces significant limitations or outright lack of support on Wayland, especially in GNOME. KDE Plasma Wayland provides a compatibility layer, but this is not universal. Developers should be aware of these differences and consider alternative approaches for tray icon functionality on modern Linux systems[2][4][5][8].",
  "citations": [
    {
      "index": 4,
      "title": "Some Qt applications with 'QT_QPA_PLATFORM=wayland' fail to ...",
      "url": "https://bbs.archlinux.org/viewtopic.php?id=266967",
      "snippet": "Since I enjoy wayland on Gnome I was interested in enabling it for my Qt applications as well. After consulting the wiki, installing 'qt5-wayland', adding the 'QT_QPA_PLATFORM=wayland' environment variable and rebooting, some (but not all!) of my Qt applications won't start anymore. While f.e. monero-wallet-gui and qt5ct work perfectly fine, i7z-gui or onlyoffice-desktopeditors don't. First, here's the error message I'm getting:\n\n```\n\nThis application failed to start because it could not find or load the Qt platform plugin \"wayland\" in \"\".\n\nAvailable platform plugins are: linuxfb, minimal, offscreen, vnc, xcb.\n\n```\n\nTo troubleshoot, I tried exporting the QT_PLUGIN_PATH variable ('export QT_PLUGIN_PATH=/usr/lib/qt/plugins') as recommended on some forums, but that didn't help.\n\nHere are my relevant environment variables:\n\n```\n\nXDG_SESSION_TYPE=wayland\n\nQT_STYLE_OVERRIDE=adwaita\n\nQT_QPA_PLATFORMTHEME=gnome\n\nQT_QPA_PLATFORM=wayland\n\n```\n\nHere are my relevant packages:\n\n```\n\nadwaita-qt 1.3.1-1\n\nqgnomeplatform 0.8.0-2\n\nqt5ct 1.2-1\n\nqt5-base 5.15.2+kde+r196-1\n\nqt5-wayland 5.15.2+kde+r23-1\n\nwayland 1.19.0-1\n\nwayland-protocols 1.21-1\n\nxorg-xwayland 21.1.1-1\n\n```... Any suggestions?\n\nOffline\n\ni7z-gui\n\nwayland doesn't allow running GUI applications as root\n\nonlyoffice-desktopeditors\n\nNo idea what that is, but sounds like a proprietary application which embeds its own Qt version, which probably doesn't include qtwayland.\n\nOffline\n\nwayland doesn't allow running GUI applications as root\n\nThat makes sense, thanks.\n\nNo idea what that is, but sounds like a proprietary application which embeds its own Qt version, which probably doesn't include qtwayland.\n\nThe command belongs to OnlyOffice, a free/libre office suite which strives for 100% compatibility with M$hit Office files (for the case where LibreOffice fails to format correctly). I got it as a binary from the AUR, so I guess that's why it isn't picking up my external qt5-wayland plugin (it appears that Qt is shipped bundled with the binary).\n\nWell, I guess that explains everything really. I assume it isn't possible, but is there something I can do to keep the 'QT_QPA_PLATFORM=wayland' environment variable globally but override/unset it for certain applications, regardless of how I call them (f.e. over the command line, over my desktop environment, when some program invokes it, etc.)?\n\n*Last edited by indignation (2021-06-07 13:37:54)*... Offline\n\nThe easiest way is probably editing the .desktop file.\n\nOffline\n\narojas wrote:\n\nwayland doesn't allow running GUI applications as root\n\nThat makes sense, thanks.\n\nYou can probably use waypipe to run the application as root and display it in your user wayland compositor, but it is not recommended to have all that GUI code running as root to minimize the attack surface.\n\nWell, I guess that explains everything really. I assume it isn't possible, but is there something I can do to keep the 'QT_QPA_PLATFORM=wayland' environment variable globally but override/unset it for certain applications, regardless of how I call them (f.e. over the command line, over my desktop environment, when some program invokes it, etc.)?\n\nAs icar suggested, use the .desktop file. https://wiki.archlinux.org/title/Deskto â€¦ _variables\n\nFor the shell define an alias or a function. You could also override the execuable in the PATH with a script in /usr/local/bin that does the necessary setup.\n\n*Last edited by progandy (2021-06-07 14:30:37)*\n\n\n\n*alias CUTF='LANG=en_XX.UTF-8@POSIX '* |\n\nOffline"
    },
    {
      "index": 5,
      "title": "qtbase/src/widgets/util/qsystemtrayicon.cpp at dev Â· qt/qtbase",
      "url": "https://github.com/qt/qtbase/blob/dev/src/widgets/util/qsystemtrayicon.cpp",
      "snippet": "// Copyright (C) 2016 The Qt Company Ltd.\n// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only\n\n#include \"qsystemtrayicon.h\"\n#include \"qsystemtrayicon_p.h\"\n\n#ifndef QT_NO_SYSTEMTRAYICON\n\n#if QT_CONFIG(menu)\n#include \"qmenu.h\"\n#endif\n#include \"qlist.h\"\n#include \"qevent.h\"\n#include \"qpoint.h\"\n#if QT_CONFIG(label)\n#include \"qlabel.h\"\n#include \"private/qlabel_p.h\"\n#endif\n#if QT_CONFIG(pushbutton)\n#include \"qpushbutton.h\"\n#endif\n#include \"qpainterpath.h\"\n#include \"qpainter.h\"\n#include \"qstyle.h\"\n#include \"qgridlayout.h\"\n#include \"qapplication.h\"\n#include \"qbitmap.h\"\n\n#include <private/qhighdpiscaling_p.h>\n#include <qpa/qplatformscreen.h>\n\nusing namespace std::chrono_literals;\n\nQT_BEGIN_NAMESPACE\n\nstatic QIcon messageIcon2qIcon(QSystemTrayIcon::MessageIcon icon)\n{\n    QStyle::StandardPixmap stdIcon = QStyle::SP_CustomBase; // silence gcc 4.9.0 about uninited variable\n    switch (icon) {\n    case QSystemTrayIcon::Information:\n        stdIcon = QStyle::SP_MessageBoxInformation;\n        break;\n    case QSystemTrayIcon::Warning:\n        stdIcon = QStyle::SP_MessageBoxWarning;\n        break;\n    case QSystemTrayIcon::Critical:\n        stdIcon = QStyle::SP_MessageBoxCritical;\n        break;\n    case QSystemTrayIcon::NoIcon:\n        return QIcon();\n    }\n    return QApplication::style()->standardIcon(stdIcon);\n}... /*!\n    \\class QSystemTrayIcon\n    \\brief The QSystemTrayIcon class provides an icon for an application in the system tray.\n    \\since 4.2\n    \\ingroup desktop\n    \\inmodule QtWidgets...     Modern operating systems usually provide a special area on the desktop,\n    called the \\e{system tray} or \\e{notification area}, where long-running\n    applications can display icons and short messages.\n\n    \\image system-tray.webp The system tray on Windows 10.\n\n    The QSystemTrayIcon class can be used on the following platforms:\n\n    \\list\n    \\li All supported versions of Windows.\n    \\li All Linux desktop environments that implement the D-Bus\n       \\l{http://www.freedesktop.org/wiki/Specifications/StatusNotifierItem/StatusNotifierItem}\n       {StatusNotifierItem specification}, including KDE, Gnome, Xfce, LXQt, and DDE.\n    \\li All window managers and independent tray implementations for X11 that implement the\n       \\l{http://standards.freedesktop.org/systemtray-spec/systemtray-spec-0.2.html}\n       {freedesktop.org XEmbed system tray specification}.\n    \\li All supported versions of \\macos.\n    \\endlist\n\n    To check whether a system tray is present on the user's desktop,\n    call the QSystemTrayIcon::isSystemTrayAvailable() static function.\n\n    To add a system tray entry, create a QSystemTrayIcon object, call setContextMenu()\n    to provide a context menu for the icon, and call show() to make it visible in the\n    system tray. Status notification messages (\"balloon messages\") can be displayed at\n    any time using showMessage().\n\n    If the system tray is unavailable when a system tray icon is constructed, but\n    becomes available later, QSystemTrayIcon will automatically add an entry for the\n    application in the system tray if the icon is \\l visible.\n\n    The activated() signal is emitted when the user activates the icon.\n\n    Only on X11, when a tooltip is requested, the QSystemTrayIcon receives a QHelpEvent\n    of type QEvent::ToolTip. Additionally, the QSystemTrayIcon receives wheel events of\n    type QEvent::Wheel. These are not supported on any other platform. Note: Since GNOME\n    Shell version 3.26, not all QSystemTrayIcon::ActivationReason are supported by the\n    system without shell extensions installed.\n\n    \\sa QDesktopServices, {Desktop Integration}, {System Tray Icon Example}... */\n\n/*!\n    \\enum QSystemTrayIcon::MessageIcon\n\n    This enum describes the icon that is shown when a balloon message is displayed.\n\n    \\value NoIcon No icon is shown.\n    \\value Information An information icon is shown.\n    \\value Warning A standard warning icon is shown.\n    \\value Critical A critical warning icon is shown.\n\n    \\sa QMessageBox\n*/\n\n/*!\n    Constructs a QSystemTrayIcon object with the given \\a parent.\n\n    The icon is initially invisible.\n\n    \\sa visible\n*/\nQSystemTrayIcon::QSystemTrayIcon(QObject *parent)\n: QObject(*new QSystemTrayIconPrivate(), parent)\n{\n}\n\n/*!\n    Constructs a QSystemTrayIcon object with the given \\a icon and \\a parent.\n\n    The icon is initially invisible.\n\n    \\sa visible\n*/\nQSystemTrayIcon::QSystemTrayIcon(const QIcon &icon, QObject *parent)\n    : QSystemTrayIcon(parent)\n{\n    setIcon(icon);\n}\n\n/*!\n    Removes the icon from the system tray and frees all allocated resources.\n*/\nQSystemTrayIcon::~QSystemTrayIcon()\n{\n    Q_D(QSystemTrayIcon);\n    d->remove_sys();\n}\n\n#if QT_CONFIG(menu)\n\n/*!\n    Sets the specified \\a menu to be the context menu for the system tray icon.... }\n\n/*!\n    Returns the current context menu for the system tray entry.\n*/\nQMenu* QSystemTrayIcon::contextMenu() const\n{\n    Q_D(const QSystemTrayIcon);\n    return d->menu;\n}\n\n#endif // QT_CONFIG(menu)\n\n/*!\n    \\property QSystemTrayIcon::icon\n    \\brief the system tray icon\n\n    On Windows, the system tray icon size is 16x16; on X11, the preferred size is\n    22x22. The icon will be scaled to the appropriate size as necessary.\n*/\nvoid QSystemTrayIcon::setIcon(const QIcon &icon)\n{\n    Q_D(QSystemTrayIcon);\n    d->icon = icon;\n    d->updateIcon_sys();\n}\n\nQIcon QSystemTrayIcon::icon() const\n{\n    Q_D(const QSystemTrayIcon);\n    return d->icon;\n}\n\n/*!\n    \\property QSystemTrayIcon::toolTip\n    \\brief the tooltip for the system tray entry\n\n    On some systems, the tooltip's length is limited. The tooltip will be truncated\n    if necessary.\n*/\nvoid QSystemTrayIcon::setToolTip(const QString &tooltip)\n{\n    Q_D(QSystemTrayIcon);\n    d->toolTip = tooltip;\n    d->updateToolTip_sys();\n}... QString QSystemTrayIcon::toolTip() const\n{\n    Q_D(const QSystemTrayIcon);\n    return d->toolTip;\n}\n\n/*!\n    \\fn void QSystemTrayIcon::show()\n\n    Shows the icon in the system tray.\n\n    \\sa hide(), visible\n*/\n\n/*!\n    \\fn void QSystemTrayIcon::hide()\n\n    Hides the system tray entry.\n\n    \\sa show(), visible\n*/\n\n/*!\n    \\since 4.3\n    Returns the geometry of the system tray icon in screen coordinates.\n\n    \\sa visible\n*/\nQRect QSystemTrayIcon::geometry() const\n{\n    Q_D(const QSystemTrayIcon);\n    if (!d->visible)\n        return QRect();\n    return d->geometry_sys();\n}\n\n/*!\n    \\property QSystemTrayIcon::visible\n    \\brief whether the system tray entry is visible\n\n    Setting this property to true or calling show() makes the system tray icon\n    visible; setting this property to false or calling hide() hides it.\n*/\nvoid QSystemTrayIcon::setVisible(bool visible)\n{\n    Q_D(QSystemTrayIcon);\n    if (visible == d->visible)\n        return;\n    if (Q_UNLIKELY(visible && d->icon.isNull()))\n        qWarning(\"QSystemTrayIcon::setVisible: No Icon set\");\n    d->visible = visible;\n    if (d->visible)\n        d->install_sys();\n    else\n        d->remove_sys();\n}...   */\nvoid QSystemTrayIcon::showMessage(const QString& title, const QString& msg,\n                            QSystemTrayIcon::MessageIcon msgIcon, int msecs)\n{\n    Q_D(QSystemTrayIcon);\n    if (d->visible)\n        d->showMessage_sys(title, msg, messageIcon2qIcon(msgIcon), msgIcon, msecs);\n}\n\n/*!\n    \\fn void QSystemTrayIcon::showMessage(const QString &title, const QString &message, const QIcon &icon, int millisecondsTimeoutHint)\n\n    \\overload showMessage()\n\n    Shows a balloon message for the entry with the given \\a title, \\a message,\n    and custom icon \\a icon for the time specified in \\a millisecondsTimeoutHint.\n\n    \\since 5.9\n*/\nvoid QSystemTrayIcon::showMessage(const QString &title, const QString &msg,\n                            const QIcon &icon, int msecs)\n{\n    Q_D(QSystemTrayIcon);\n    if (d->visible)\n        d->showMessage_sys(title, msg, icon, QSystemTrayIcon::NoIcon, msecs);\n}\n\nvoid QSystemTrayIconPrivate::_q_emitActivated(QPlatformSystemTrayIcon::ActivationReason reason)\n{\n    Q_Q(QSystemTrayIcon);\n    emit q->activated(static_cast<QSystemTrayIcon::ActivationReason>(reason));\n}"
    },
    {
      "index": 5,
      "title": "qtbase/src/widgets/util/qsystemtrayicon.cpp at dev Â· qt/qtbase",
      "url": "https://github.com/qt/qtbase/blob/dev/src/widgets/util/qsystemtrayicon.cpp",
      "snippet": "// Copyright (C) 2016 The Qt Company Ltd.\n// SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only\n\n#include \"qsystemtrayicon.h\"\n#include \"qsystemtrayicon_p.h\"\n\n#ifndef QT_NO_SYSTEMTRAYICON\n\n#if QT_CONFIG(menu)\n#include \"qmenu.h\"\n#endif\n#include \"qlist.h\"\n#include \"qevent.h\"\n#include \"qpoint.h\"\n#if QT_CONFIG(label)\n#include \"qlabel.h\"\n#include \"private/qlabel_p.h\"\n#endif\n#if QT_CONFIG(pushbutton)\n#include \"qpushbutton.h\"\n#endif\n#include \"qpainterpath.h\"\n#include \"qpainter.h\"\n#include \"qstyle.h\"\n#include \"qgridlayout.h\"\n#include \"qapplication.h\"\n#include \"qbitmap.h\"\n\n#include <private/qhighdpiscaling_p.h>\n#include <qpa/qplatformscreen.h>\n\nusing namespace std::chrono_literals;\n\nQT_BEGIN_NAMESPACE\n\nstatic QIcon messageIcon2qIcon(QSystemTrayIcon::MessageIcon icon)\n{\n    QStyle::StandardPixmap stdIcon = QStyle::SP_CustomBase; // silence gcc 4.9.0 about uninited variable\n    switch (icon) {\n    case QSystemTrayIcon::Information:\n        stdIcon = QStyle::SP_MessageBoxInformation;\n        break;\n    case QSystemTrayIcon::Warning:\n        stdIcon = QStyle::SP_MessageBoxWarning;\n        break;\n    case QSystemTrayIcon::Critical:\n        stdIcon = QStyle::SP_MessageBoxCritical;\n        break;\n    case QSystemTrayIcon::NoIcon:\n        return QIcon();\n    }\n    return QApplication::style()->standardIcon(stdIcon);\n}... /*!\n    \\class QSystemTrayIcon\n    \\brief The QSystemTrayIcon class provides an icon for an application in the system tray.\n    \\since 4.2\n    \\ingroup desktop\n    \\inmodule QtWidgets...     Modern operating systems usually provide a special area on the desktop,\n    called the \\e{system tray} or \\e{notification area}, where long-running\n    applications can display icons and short messages.\n\n    \\image system-tray.webp The system tray on Windows 10.\n\n    The QSystemTrayIcon class can be used on the following platforms:\n\n    \\list\n    \\li All supported versions of Windows.\n    \\li All Linux desktop environments that implement the D-Bus\n       \\l{http://www.freedesktop.org/wiki/Specifications/StatusNotifierItem/StatusNotifierItem}\n       {StatusNotifierItem specification}, including KDE, Gnome, Xfce, LXQt, and DDE.\n    \\li All window managers and independent tray implementations for X11 that implement the\n       \\l{http://standards.freedesktop.org/systemtray-spec/systemtray-spec-0.2.html}\n       {freedesktop.org XEmbed system tray specification}.\n    \\li All supported versions of \\macos.\n    \\endlist\n\n    To check whether a system tray is present on the user's desktop,\n    call the QSystemTrayIcon::isSystemTrayAvailable() static function.\n\n    To add a system tray entry, create a QSystemTrayIcon object, call setContextMenu()\n    to provide a context menu for the icon, and call show() to make it visible in the\n    system tray. Status notification messages (\"balloon messages\") can be displayed at\n    any time using showMessage().\n\n    If the system tray is unavailable when a system tray icon is constructed, but\n    becomes available later, QSystemTrayIcon will automatically add an entry for the\n    application in the system tray if the icon is \\l visible.\n\n    The activated() signal is emitted when the user activates the icon.\n\n    Only on X11, when a tooltip is requested, the QSystemTrayIcon receives a QHelpEvent\n    of type QEvent::ToolTip. Additionally, the QSystemTrayIcon receives wheel events of\n    type QEvent::Wheel. These are not supported on any other platform. Note: Since GNOME\n    Shell version 3.26, not all QSystemTrayIcon::ActivationReason are supported by the\n    system without shell extensions installed.\n\n    \\sa QDesktopServices, {Desktop Integration}, {System Tray Icon Example}... */\n\n/*!\n    \\enum QSystemTrayIcon::MessageIcon\n\n    This enum describes the icon that is shown when a balloon message is displayed.\n\n    \\value NoIcon No icon is shown.\n    \\value Information An information icon is shown.\n    \\value Warning A standard warning icon is shown.\n    \\value Critical A critical warning icon is shown.\n\n    \\sa QMessageBox\n*/\n\n/*!\n    Constructs a QSystemTrayIcon object with the given \\a parent.\n\n    The icon is initially invisible.\n\n    \\sa visible\n*/\nQSystemTrayIcon::QSystemTrayIcon(QObject *parent)\n: QObject(*new QSystemTrayIconPrivate(), parent)\n{\n}\n\n/*!\n    Constructs a QSystemTrayIcon object with the given \\a icon and \\a parent.\n\n    The icon is initially invisible.\n\n    \\sa visible\n*/\nQSystemTrayIcon::QSystemTrayIcon(const QIcon &icon, QObject *parent)\n    : QSystemTrayIcon(parent)\n{\n    setIcon(icon);\n}\n\n/*!\n    Removes the icon from the system tray and frees all allocated resources.\n*/\nQSystemTrayIcon::~QSystemTrayIcon()\n{\n    Q_D(QSystemTrayIcon);\n    d->remove_sys();\n}\n\n#if QT_CONFIG(menu)\n\n/*!\n    Sets the specified \\a menu to be the context menu for the system tray icon.... }\n\n/*!\n    Returns the current context menu for the system tray entry.\n*/\nQMenu* QSystemTrayIcon::contextMenu() const\n{\n    Q_D(const QSystemTrayIcon);\n    return d->menu;\n}\n\n#endif // QT_CONFIG(menu)\n\n/*!\n    \\property QSystemTrayIcon::icon\n    \\brief the system tray icon\n\n    On Windows, the system tray icon size is 16x16; on X11, the preferred size is\n    22x22. The icon will be scaled to the appropriate size as necessary.\n*/\nvoid QSystemTrayIcon::setIcon(const QIcon &icon)\n{\n    Q_D(QSystemTrayIcon);\n    d->icon = icon;\n    d->updateIcon_sys();\n}\n\nQIcon QSystemTrayIcon::icon() const\n{\n    Q_D(const QSystemTrayIcon);\n    return d->icon;\n}\n\n/*!\n    \\property QSystemTrayIcon::toolTip\n    \\brief the tooltip for the system tray entry\n\n    On some systems, the tooltip's length is limited. The tooltip will be truncated\n    if necessary.\n*/\nvoid QSystemTrayIcon::setToolTip(const QString &tooltip)\n{\n    Q_D(QSystemTrayIcon);\n    d->toolTip = tooltip;\n    d->updateToolTip_sys();\n}... QString QSystemTrayIcon::toolTip() const\n{\n    Q_D(const QSystemTrayIcon);\n    return d->toolTip;\n}\n\n/*!\n    \\fn void QSystemTrayIcon::show()\n\n    Shows the icon in the system tray.\n\n    \\sa hide(), visible\n*/\n\n/*!\n    \\fn void QSystemTrayIcon::hide()\n\n    Hides the system tray entry.\n\n    \\sa show(), visible\n*/\n\n/*!\n    \\since 4.3\n    Returns the geometry of the system tray icon in screen coordinates.\n\n    \\sa visible\n*/\nQRect QSystemTrayIcon::geometry() const\n{\n    Q_D(const QSystemTrayIcon);\n    if (!d->visible)\n        return QRect();\n    return d->geometry_sys();\n}\n\n/*!\n    \\property QSystemTrayIcon::visible\n    \\brief whether the system tray entry is visible\n\n    Setting this property to true or calling show() makes the system tray icon\n    visible; setting this property to false or calling hide() hides it.\n*/\nvoid QSystemTrayIcon::setVisible(bool visible)\n{\n    Q_D(QSystemTrayIcon);\n    if (visible == d->visible)\n        return;\n    if (Q_UNLIKELY(visible && d->icon.isNull()))\n        qWarning(\"QSystemTrayIcon::setVisible: No Icon set\");\n    d->visible = visible;\n    if (d->visible)\n        d->install_sys();\n    else\n        d->remove_sys();\n}...   */\nvoid QSystemTrayIcon::showMessage(const QString& title, const QString& msg,\n                            QSystemTrayIcon::MessageIcon msgIcon, int msecs)\n{\n    Q_D(QSystemTrayIcon);\n    if (d->visible)\n        d->showMessage_sys(title, msg, messageIcon2qIcon(msgIcon), msgIcon, msecs);\n}\n\n/*!\n    \\fn void QSystemTrayIcon::showMessage(const QString &title, const QString &message, const QIcon &icon, int millisecondsTimeoutHint)\n\n    \\overload showMessage()\n\n    Shows a balloon message for the entry with the given \\a title, \\a message,\n    and custom icon \\a icon for the time specified in \\a millisecondsTimeoutHint.\n\n    \\since 5.9\n*/\nvoid QSystemTrayIcon::showMessage(const QString &title, const QString &msg,\n                            const QIcon &icon, int msecs)\n{\n    Q_D(QSystemTrayIcon);\n    if (d->visible)\n        d->showMessage_sys(title, msg, icon, QSystemTrayIcon::NoIcon, msecs);\n}\n\nvoid QSystemTrayIconPrivate::_q_emitActivated(QPlatformSystemTrayIcon::ActivationReason reason)\n{\n    Q_Q(QSystemTrayIcon);\n    emit q->activated(static_cast<QSystemTrayIcon::ActivationReason>(reason));\n}"
    },
    {
      "index": 2,
      "title": "QSystemTrayIcon, change behavior - Qt Forum",
      "url": "https://forum.qt.io/topic/123729/qsystemtrayicon-change-behavior",
      "snippet": "# QSystemTrayIcon, change behavior\n\n\n\nI just learned how use the QSystemTrayIcon, however it works in a way that is not exactly what I want.\n\nThis is the code(snippet) that I am using :\n\n`void MainWindow::on_button_clicked() { // tray is declared in the class and initialized with the icon in the constructor tray->show(); tray->showMessage(\"A test\", \"this has proved to be working\", QSystemTrayIcon::NoIcon ); / tray->setVisible(false); }`\n\nWith this code the tray is shown as expected but after the tray disappears the icon stay here:\n\nwhich is something I don't want since it has no use there(didn't set any contextmenu)\n\nIf after I\n\n`showMessage()`I set the tray to invisible it removes the icon from there but the notification won't stay in the notification area.\n\nIs there a way to change this behavior?\n\n\n\nHi,\n\nA tray icon does not necessarily have a contextual menu, it might also just provide some information.\n\nYour situation is not really clear.\n\nWhat do you want from your system tray icon ?\n\n\n\nHi,\n\nA tray icon does not necessarily have a contextual menu, it might also just provide some information.\n\nYour situation is not really clear.\n\nWhat do you want from your system tray icon ?... @SGaist thanks for the quick reply\n\nWhat do you want from your system tray icon ?\n\nThis is the message it shows.\n\nAfter this message disappears, the icon I set for the tray continues here:\n\nI don't want that.\n\nI can set the visibility to false after\n\n`showMessage()`but then, the message won't stay in the notification area.\n\nI hope I made the question clear.\n\n\n\nSo you just want the notification but not the icon ?\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\nWhere do I find the code?Lifetime Qt Champion\n\nIn the git repo or e.g. here: https://code.woboq.org/qt5/qtbase/src/widgets/util/qsystemtrayicon.cpp.html\n\n\n\nIn the git repo or e.g. here: https://code.woboq.org/qt5/qtbase/src/widgets/util/qsystemtrayicon.cpp.html\n\n@Christian-Ehrlicher thank you... Is there any step by step on how to build it from source, or in which category here in the forum can I post a question?\n\n\n\nLifetime Qt Champion\n\n\n\n@Christian-Ehrlicher just out of curiosity\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\n\n\n@hbatalha said in QSystemTrayIcon, change behavior:\n\nWhat exactly did you mean by \"pilfer the backend \"? Should I remove some code?\n\nNo, you should get some inspiration from it.\n\n\n\n@hbatalha said in QSystemTrayIcon, change behavior:\n\nWhat exactly did you mean by \"pilfer the backend \"? Should I remove some code?\n\nNo, you should get some inspiration from it.\n\n\n\nYou have to do some more spelunking and go to the backend side of things to get the Windows specific implementation.\n\n\n\nYou have to do some more spelunking and go to the backend side of things to get the Windows specific implementation."
    },
    {
      "index": 2,
      "title": "QSystemTrayIcon, change behavior - Qt Forum",
      "url": "https://forum.qt.io/topic/123729/qsystemtrayicon-change-behavior",
      "snippet": "# QSystemTrayIcon, change behavior\n\n\n\nI just learned how use the QSystemTrayIcon, however it works in a way that is not exactly what I want.\n\nThis is the code(snippet) that I am using :\n\n`void MainWindow::on_button_clicked() { // tray is declared in the class and initialized with the icon in the constructor tray->show(); tray->showMessage(\"A test\", \"this has proved to be working\", QSystemTrayIcon::NoIcon ); / tray->setVisible(false); }`\n\nWith this code the tray is shown as expected but after the tray disappears the icon stay here:\n\nwhich is something I don't want since it has no use there(didn't set any contextmenu)\n\nIf after I\n\n`showMessage()`I set the tray to invisible it removes the icon from there but the notification won't stay in the notification area.\n\nIs there a way to change this behavior?\n\n\n\nHi,\n\nA tray icon does not necessarily have a contextual menu, it might also just provide some information.\n\nYour situation is not really clear.\n\nWhat do you want from your system tray icon ?\n\n\n\nHi,\n\nA tray icon does not necessarily have a contextual menu, it might also just provide some information.\n\nYour situation is not really clear.\n\nWhat do you want from your system tray icon ?... @SGaist thanks for the quick reply\n\nWhat do you want from your system tray icon ?\n\nThis is the message it shows.\n\nAfter this message disappears, the icon I set for the tray continues here:\n\nI don't want that.\n\nI can set the visibility to false after\n\n`showMessage()`but then, the message won't stay in the notification area.\n\nI hope I made the question clear.\n\n\n\nSo you just want the notification but not the icon ?\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\nWhere do I find the code?Lifetime Qt Champion\n\nIn the git repo or e.g. here: https://code.woboq.org/qt5/qtbase/src/widgets/util/qsystemtrayicon.cpp.html\n\n\n\nIn the git repo or e.g. here: https://code.woboq.org/qt5/qtbase/src/widgets/util/qsystemtrayicon.cpp.html\n\n@Christian-Ehrlicher thank you... Is there any step by step on how to build it from source, or in which category here in the forum can I post a question?\n\n\n\nLifetime Qt Champion\n\n\n\n@Christian-Ehrlicher just out of curiosity\n\n\n\nThen you might have to pilfer the backend code of QSystemTrayIcon since you have no use of it beside the notification part.\n\n\n\n@hbatalha said in QSystemTrayIcon, change behavior:\n\nWhat exactly did you mean by \"pilfer the backend \"? Should I remove some code?\n\nNo, you should get some inspiration from it.\n\n\n\n@hbatalha said in QSystemTrayIcon, change behavior:\n\nWhat exactly did you mean by \"pilfer the backend \"? Should I remove some code?\n\nNo, you should get some inspiration from it.\n\n\n\nYou have to do some more spelunking and go to the backend side of things to get the Windows specific implementation.\n\n\n\nYou have to do some more spelunking and go to the backend side of things to get the Windows specific implementation."
    }
  ],
  "planLog": [
    "ðŸŽ¯ GOAP Planning & Execution Log",
    "================================",
    "ðŸ“‹ Plan Execution Summary:",
    "  â€¢ Steps executed: 4",
    "  â€¢ Success: Yes",
    "  â€¢ Replanned: No"
  ],
  "usage": {
    "tokens": 13489,
    "cost": 0.06744499999999999
  },
  "metadata": {
    "planId": "plan_2",
    "executionTime": 55187,
    "replanned": false
  },
  "paginationInfo": {
    "page": 1,
    "pageSize": 5,
    "totalPages": 6,
    "totalItems": 29,
    "hasNext": true,
    "hasPrevious": false
  }
}