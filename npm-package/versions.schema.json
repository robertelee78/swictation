{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/robertelee78/swictation/blob/main/npm-package/versions.schema.json",
  "title": "Swictation Versions Schema",
  "description": "Schema for versions.json - the single source of truth for all version numbers",
  "type": "object",
  "required": ["distribution", "components", "libraries", "metadata"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "$comment": {
      "type": "string",
      "description": "Overall file comment"
    },
    "distribution": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Main npm package version (semver). All platform packages must use this version."
    },
    "_distribution_comment": {
      "type": "string",
      "description": "Explanation of distribution version"
    },
    "components": {
      "type": "object",
      "description": "Component versions from Rust Cargo.toml files",
      "required": ["daemon", "ui", "context-learning"],
      "properties": {
        "_comment": {
          "type": "string"
        },
        "daemon": {
          "type": "object",
          "required": ["version", "source", "description"],
          "properties": {
            "version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "source": {
              "type": "string",
              "description": "Path to Cargo.toml file"
            },
            "description": {
              "type": "string"
            }
          }
        },
        "ui": {
          "type": "object",
          "required": ["version", "source", "description"],
          "properties": {
            "version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "source": {
              "type": "string"
            },
            "description": {
              "type": "string"
            }
          }
        },
        "context-learning": {
          "type": "object",
          "required": ["version", "source", "description"],
          "properties": {
            "version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "source": {
              "type": "string"
            },
            "description": {
              "type": "string"
            }
          }
        }
      },
      "additionalProperties": false
    },
    "libraries": {
      "type": "object",
      "description": "Third-party library versions",
      "required": ["onnxruntime", "cuda", "cudnn"],
      "properties": {
        "_comment": {
          "type": "string"
        },
        "onnxruntime": {
          "type": "object",
          "required": ["linux-cpu", "linux-gpu", "macos-coreml"],
          "properties": {
            "linux-cpu": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "linux-gpu": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "macos-coreml": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "_comment": {
              "type": "string"
            },
            "_sources": {
              "type": "object"
            }
          }
        },
        "cuda": {
          "type": "object",
          "required": ["version"],
          "properties": {
            "version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+$"
            },
            "legacy_version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+$"
            },
            "_comment": {
              "type": "string"
            }
          }
        },
        "cudnn": {
          "type": "object",
          "required": ["version"],
          "properties": {
            "version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "_comment": {
              "type": "string"
            }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "required": ["last_updated", "schema_version"],
      "properties": {
        "_comment": {
          "type": "string"
        },
        "last_updated": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}",
          "description": "ISO 8601 timestamp of last update"
        },
        "schema_version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Version of this schema format"
        },
        "git_commit": {
          "type": "string",
          "description": "Optional git commit hash"
        }
      }
    }
  },
  "additionalProperties": false
}
